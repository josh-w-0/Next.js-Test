<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classic Snake Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Press Start 2P', cursive;
            -webkit-touch-callout: none; /* iOS Safari */
            -webkit-user-select: none;   /* Safari */
            -khtml-user-select: none;    /* Konqueror HTML */
            -moz-user-select: none;      /* Old versions of Firefox */
            -ms-user-select: none;       /* Internet Explorer/Edge */
            user-select: none;           /* Non-prefixed version, currently supported by Chrome, Edge, Opera and Firefox */
        }
        .pixelated {
            image-rendering: pixelated;
        }
        .glowing-text {
            text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #00ff00, 0 0 20px #00ff00;
        }
        .glowing-border {
            box-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00;
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex flex-col items-center justify-center min-h-screen p-4 overflow-hidden">

    <div class="w-full max-w-lg md:max-w-xl lg:max-w-2xl text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-2 glowing-text">SNAKE</h1>
        <p class="text-green-400 mb-4">The classic arcade game</p>
    
        <!-- Scoreboard -->
        <div class="flex justify-between text-lg md:text-xl mb-4 bg-gray-800 p-3 rounded-lg border-2 border-green-500 glowing-border">
            <div>SCORE: <span id="score">0</span></div>
            <div>HIGH SCORE: <span id="high-score">0</span></div>
        </div>
    
        <!-- Game Canvas -->
        <div class="relative w-full" style="padding-bottom: 100%;"> <!-- Aspect ratio container -->
            <canvas id="gameCanvas" class="absolute top-0 left-0 w-full h-full bg-black rounded-lg border-2 border-green-500 glowing-border"></canvas>
            <!-- Game Over / Start Screen -->
            <div id="startScreen" class="absolute top-0 left-0 w-full h-full flex flex-col items-center justify-center bg-black bg-opacity-70 rounded-lg">
                <h2 id="message" class="text-3xl md:text-4xl font-bold text-white glowing-text">Press Start</h2>
                <p class="text-sm text-gray-300 mt-4">(Use Arrow Keys or Swipe)</p>
            </div>
        </div>
    
        <!-- Start/Restart Button -->
        <button id="startButton" class="mt-6 w-full py-3 px-6 bg-green-500 text-gray-900 font-bold text-2xl rounded-lg border-b-4 border-green-700 hover:bg-green-400 hover:border-green-600 active:border-b-0 active:translate-y-1 transition-all duration-150">
            START
        </button>
    </div>

    <script>
        // DOM Elements
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const highScoreEl = document.getElementById('high-score');
        const startButton = document.getElementById('startButton');
        const startScreen = document.getElementById('startScreen');
        const messageEl = document.getElementById('message');

        // Game Constants
        const GRID_SIZE = 20;
        const FPS = 10;

        // State
        let canvasSize;
        let TILE_COUNT;
        let snake, food, dx, dy, score, highScore, gameInterval, gameRunning;
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;

        // Initialize and resize canvas
        function setupCanvas() {
            const container = canvas.parentElement;
            const size = container.clientWidth;
            canvas.width = size;
            canvas.height = size;
            canvasSize = size;
            TILE_COUNT = canvasSize / GRID_SIZE;
        }

        // Initialize Game State
        function init() {
            snake = [{ x: Math.floor(TILE_COUNT / 2), y: Math.floor(TILE_COUNT / 2) }];
            dx = 0;
            dy = 0;
            score = 0;
            scoreEl.textContent = '0';
            gameRunning = false;
            if (gameInterval) clearInterval(gameInterval);
            placeFood();
            draw();
            startScreen.style.display = 'flex';
            messageEl.textContent = "Press Start";
            startButton.textContent = "START";
        }

        // Game Loop
        function gameLoop() {
            if (!gameRunning) return;

            // Move snake
            const head = { x: snake[0].x + dx, y: snake[0].y + dy };
            snake.unshift(head);

            // Check for collisions
            // Wall collision
            if (head.x < 0 || head.x >= TILE_COUNT || head.y < 0 || head.y >= TILE_COUNT) {
                return gameOver();
            }
            // Self collision
            for (let i = 1; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    return gameOver();
                }
            }

            // Check for food
            if (head.x === food.x && head.y === food.y) {
                score++;
                scoreEl.textContent = score;
                placeFood();
            } else {
                snake.pop();
            }

            draw();
        }

        // Draw everything on canvas
        function draw() {
            // Clear canvas
            ctx.fillStyle = '#111827'; // Dark gray, matching the theme
            ctx.fillRect(0, 0, canvasSize, canvasSize);

            // Draw snake
            ctx.fillStyle = '#4ade80'; // Green-400
            snake.forEach((part, index) => {
                ctx.fillStyle = index === 0 ? '#10b981' : '#4ade80'; // Darker green head
                ctx.fillRect(part.x * GRID_SIZE, part.y * GRID_SIZE, GRID_SIZE - 2, GRID_SIZE - 2);
            });

            // Draw food
            ctx.fillStyle = '#ef4444'; // Red-500
            ctx.fillRect(food.x * GRID_SIZE, food.y * GRID_SIZE, GRID_SIZE, GRID_SIZE);
            ctx.fillStyle = '#f87171'; // Red-400
             ctx.fillRect(food.x * GRID_SIZE + GRID_SIZE/4, food.y * GRID_SIZE + GRID_SIZE/4, GRID_SIZE/2, GRID_SIZE/2);
        }

        // Place food randomly
        function placeFood() {
            food = {
                x: Math.floor(Math.random() * TILE_COUNT),
                y: Math.floor(Math.random() * TILE_COUNT)
            };
            // Ensure food doesn't spawn on the snake
            for (const part of snake) {
                if (part.x === food.x && part.y === food.y) {
                    placeFood();
                    break;
                }
            }
        }

        // Game Over
        function gameOver() {
            gameRunning = false;
            clearInterval(gameInterval);
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('snakeHighScore', highScore);
                highScoreEl.textContent = highScore;
            }
            startScreen.style.display = 'flex';
            messageEl.textContent = "GAME OVER";
            startButton.textContent = "RESTART";
        }

        // Start Game
        function startGame() {
            if (gameRunning && dx === 0 && dy === 0) return; // Prevent restart if game is running but snake isn't moving
            if (!gameRunning) {
                init(); // Reset game state if it was over
            }
            gameRunning = true;
            startScreen.style.display = 'none';
            gameInterval = setInterval(gameLoop, 1000 / FPS);
        }
        
        // Handle Keyboard Input
        function handleKeyDown(e) {
            if (!gameRunning && e.key.includes('Arrow')) {
                 startGame();
            }

            switch (e.key) {
                case 'ArrowUp':
                    if (dy === 0) { dx = 0; dy = -1; }
                    break;
                case 'ArrowDown':
                    if (dy === 0) { dx = 0; dy = 1; }
                    break;
                case 'ArrowLeft':
                    if (dx === 0) { dx = -1; dy = 0; }
                    break;
                case 'ArrowRight':
                    if (dx === 0) { dx = 1; dy = 0; }
                    break;
            }
        }
        
        // Handle Touch Input
        function handleTouchStart(e) {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }

        function handleTouchEnd(e) {
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            handleSwipe();
        }

        function handleSwipe() {
            const deltaX = touchEndX - touchStartX;
            const deltaY = touchEndY - touchStartY;
            
            if (Math.abs(deltaX) > Math.abs(deltaY)) { // Horizontal swipe
                if (deltaX > 0 && dx === 0) { // Right
                    dx = 1; dy = 0;
                } else if (deltaX < 0 && dx === 0) { // Left
                    dx = -1; dy = 0;
                }
            } else { // Vertical swipe
                if (deltaY > 0 && dy === 0) { // Down
                    dx = 0; dy = 1;
                } else if (deltaY < 0 && dy === 0) { // Up
                    dx = 0; dy = -1;
                }
            }
            if (!gameRunning && (dx !== 0 || dy !== 0)) {
                startGame();
            }
        }


        // Load high score from local storage
        function loadHighScore() {
            highScore = localStorage.getItem('snakeHighScore') || 0;
            highScoreEl.textContent = highScore;
        }

        // Event Listeners
        window.addEventListener('resize', () => {
             setupCanvas();
             draw();
        });
        document.addEventListener('keydown', handleKeyDown);
        startButton.addEventListener('click', startGame);
        canvas.addEventListener('touchstart', handleTouchStart, false);
        canvas.addEventListener('touchend', handleTouchEnd, false);

        // Initial Load
        setupCanvas();
        loadHighScore();
        init();
    </script>
</body>
</html>
